<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>관리자 페이지</title>
<style>
  body{margin:0;font-family:'Segoe UI',sans-serif;background:#f0f4f8;color:#333;}
  header{background:#ef4444;color:white;padding:16px;text-align:center;font-size:1.5rem;}
  main{max-width:800px;margin:30px auto;padding:20px;background:white;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.1);}
  .q-item{margin-bottom:12px;padding:12px;border-left:4px solid #ef4444;background:#f9fafb;border-radius:6px;display:flex;justify-content:space-between;align-items:center;}
  .q-item div{max-width:70%;}
  button{padding:6px 12px;margin-left:6px;border:none;border-radius:6px;background:#ef4444;color:white;cursor:pointer;}
  button:hover{background:#b91c1c;}
</style>
</head>
<body>
<header>관리자 페이지</header>
<main>
  <div id="queue-list"></div>
</main>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
const ROOM = 'tobrothertoiden';
const firebaseConfig = {
  apiKey: "AIzaSyBiDe-6X-nKUfAgwWWWriI2U9wpNpQ9hk8",
  authDomain: "toiden.firebaseapp.com",
  databaseURL: "https://toiden-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "toiden",
  storageBucket: "toiden.firebasestorage.app",
  messagingSenderId: "696461176231",
  appId: "1:696461176231:web:2120f172e52eaba91a1a82"
};
firebase.initializeApp(firebaseConfig);

const dbRef = firebase.database().ref(`rooms/${ROOM}/queue`);
const $queue = document.getElementById('queue-list');

function renderQueue(queue){
  $queue.innerHTML='';
  Object.entries(queue).forEach(([key,item])=>{
    const div = document.createElement('div');
    div.className='q-item';
    div.innerHTML=`<div><b>${item.name}</b><br>${item.url}<br>${item.msg||''}</div>`;
    const btnDel = document.createElement('button');
    btnDel.textContent='삭제';
    btnDel.onclick=()=> dbRef.child(key).remove();
    div.appendChild(btnDel);
    $queue.appendChild(div);
  });
}

dbRef.on('value', snap=>{
  const val = snap.val()||{};
  renderQueue(val);
});
</script>
</body>
</html>
