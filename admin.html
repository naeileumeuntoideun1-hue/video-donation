<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>관리자 페이지</title>
<style>
body{font-family:sans-serif;background:#f0f0f0;padding:20px;}
table{width:100%;border-collapse:collapse;}
th,td{border:1px solid #ccc;padding:8px;text-align:left;}
button{padding:5px 10px;margin:2px;cursor:pointer;}
button.delete{background:#dc3545;color:#fff;border:none;}
button.play{background:#28a745;color:#fff;border:none;}
</style>
</head>
<body>
<h2>영상 관리</h2>
<table>
<thead><tr><th>이름</th><th>URL</th><th>타입</th><th>메시지</th><th>액션</th></tr></thead>
<tbody id="list"></tbody>
</table>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
const firebaseConfig = {
  apiKey:"AIzaSyBiDe-6X-nKUfAgwWWWriI2U9wpNpQ9hk8",
  authDomain:"toiden.firebaseapp.com",
  databaseURL:"https://toiden-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:"toiden",
  storageBucket:"toiden.firebasestorage.app",
  messagingSenderId:"696461176231",
  appId:"1:696461176231:web:2120f172e52eaba91a1a82"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database().ref('rooms/tobrothertoiden/queue');
const $list=document.getElementById('list');

function renderList(data){
  $list.innerHTML='';
  Object.keys(data).forEach(k=>{
    const item=data[k];
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${item.name}</td>
<td>${item.url}</td>
<td>${item.type}</td>
<td>${item.msg}</td>
<td>
<button class="play">송출</button>
<button class="delete">삭제</button>
</td>`;
    tr.querySelector('.delete').onclick=()=>db.child(k).remove();
    tr.querySelector('.play').onclick=()=>db.child(k).update({play:true});
    $list.appendChild(tr);
  });
}

db.on('value',snap=>renderList(snap.val()||{}));
</script>
</body>
</html>
