<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>관리자 페이지</title>
<style>
body{font-family:sans-serif;background:#0f172a;color:#e6edf3;display:flex;justify-content:center;padding:20px;}
.card{background:#111826;padding:20px;border-radius:20px;max-width:800px;width:100%;}
button{padding:8px 12px;margin-left:4px;border-radius:12px;border:none;cursor:pointer;}
.btn-play{background:#22c55e;color:#05120a;font-weight:700;}
.btn-remove{background:#ef4444;color:#fff;}
.q-item{background:rgba(255,255,255,0.05);padding:10px;border-radius:12px;margin-top:8px;display:flex;justify-content:space-between;align-items:center;}
</style>
</head>
<body>
<div class="card">
<h2>관리자 페이지</h2>
<div id="queue"></div>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
const firebaseConfig = {apiKey:"AIzaSyBiDe-6X-nKUfAgwWWWriI2U9wpNpQ9hk8",authDomain:"toiden.firebaseapp.com",databaseURL:"https://toiden-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"toiden",storageBucket:"toiden.firebasestorage.app",messagingSenderId:"696461176231",appId:"1:696461176231:web:2120f172e52eaba91a1a82"};
firebase.initializeApp(firebaseConfig);
const db = firebase.database().ref('rooms/tobrothertoiden/queue');
function renderQueue(list){
  const $q=document.getElementById('queue'); $q.innerHTML='';
  list.forEach(item=>{
    const el=document.createElement('div'); el.className='q-item';
    el.innerHTML=`<span>${item.name} - ${item.msg || ''}</span>
      <div>
      <button class="btn-play" data-key="${item.key}">송출</button>
      <button class="btn-remove" data-key="${item.key}">삭제</button>
      </div>`;
    $q.appendChild(el);
  });
  $q.querySelectorAll('.btn-remove').forEach(b=>b.addEventListener('click',e=>{const k=e.target.dataset.key;db.child(k).remove();}));
  $q.querySelectorAll('.btn-play').forEach(b=>b.addEventListener('click',e=>{const k=e.target.dataset.key;db.child(k).update({play:true});}));
}
db.on('value',snap=>{
  const val=snap.val()||{};
  const list=Object.keys(val).map(k=>({...val[k],key:k}));
  renderQueue(list);
});
</script>
</div>
</body>
</html>
