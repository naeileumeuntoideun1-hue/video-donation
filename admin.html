<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  button { margin: 5px; padding: 10px 20px; }
  .video-item { margin-bottom: 15px; border: 1px solid #ccc; padding: 10px; }
</style>
<script type="module">
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";

const firebaseConfig = {
  apiKey: "AIzaSyBiDe-6X-nKUfAgwWWWriI2U9wpNpQ9hk8",
  authDomain: "toiden.firebaseapp.com",
  databaseURL: "https://toiden-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "toiden",
  storageBucket: "toiden.firebasestorage.app",
  messagingSenderId: "696461176231",
  appId: "1:696461176231:web:2120f172e52eaba91a1a82"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const roomName = "tobrothertoiden";
const listContainer = document.createElement('div');
document.body.appendChild(listContainer);

function renderQueue(queue) {
    listContainer.innerHTML = "";
    Object.keys(queue).forEach(key => {
        const item = queue[key];
        const div = document.createElement("div");
        div.className = "video-item";
        div.innerHTML = `
            <strong>${item.name}</strong> (${item.type})<br>
            <button data-key="${key}">송출</button>
        `;
        listContainer.appendChild(div);
        div.querySelector("button").onclick = () => {
            set(ref(db, `rooms/${roomName}/current`), { key, video: item });
        };
    });
}

onValue(ref(db, `rooms/${roomName}/queue`), snapshot => {
    renderQueue(snapshot.val() || {});
});
</script>
</head>
<body>
<h1>관리자 패널</h1>
<p>송출 버튼을 누르면 OBS overlay에 영상이 나타납니다.</p>
</body>
</html>
