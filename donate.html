<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>영상 후원</title>
<style>
body{font-family:sans-serif;background:#f0f0f0;padding:20px;}
.container{max-width:500px;margin:auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
input,textarea,button{width:100%;margin:5px 0;padding:10px;border-radius:4px;border:1px solid #ccc;}
button{background:#007bff;color:#fff;border:none;cursor:pointer;}
button:hover{background:#0056b3;}
</style>
</head>
<body>
<div class="container">
<h2>영상 후원하기</h2>
<input type="text" id="name" placeholder="이름 (선택)">
<input type="text" id="url" placeholder="영상 URL (YouTube/Twitch/MP4)">
<select id="type">
<option value="youtube">YouTube</option>
<option value="html5">MP4</option>
<option value="twitch">Twitch</option>
</select>
<textarea id="msg" placeholder="응원 메시지 (선택)"></textarea>
<button id="submit">보내기</button>
<div id="status"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
const firebaseConfig = {
  apiKey:"AIzaSyBiDe-6X-nKUfAgwWWWriI2U9wpNpQ9hk8",
  authDomain:"toiden.firebaseapp.com",
  databaseURL:"https://toiden-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:"toiden",
  storageBucket:"toiden.firebasestorage.app",
  messagingSenderId:"696461176231",
  appId:"1:696461176231:web:2120f172e52eaba91a1a82"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database().ref('rooms/tobrothertoiden/queue');

document.getElementById('submit').onclick = ()=>{
  const name = document.getElementById('name').value||'익명';
  const url = document.getElementById('url').value.trim();
  const type = document.getElementById('type').value;
  const msg = document.getElementById('msg').value||'';
  if(!url){ document.getElementById('status').innerText='URL을 입력해주세요.'; return; }
  
  let ytid=null;
  if(type==='youtube') {
    const match = url.match(/(?:v=|\.be\/)([\w-]{11})/);
    if(match) ytid=match[1];
  }

  db.push({name,url,type,ytid,msg,ts:Date.now(),play:true});
  document.getElementById('status').innerText='전송 완료!';
  document.getElementById('name').value='';
  document.getElementById('url').value='';
  document.getElementById('msg').value='';
}
</script>
</body>
</html>
